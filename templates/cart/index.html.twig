{% extends 'base.html.twig' %}

{% block title %}Mon Panier - OPALE PARIS{% endblock %}

{% block body %}
    <div class="cart-page-container">
        <h1 class="page-title">Mon Panier</h1>

        {% if items is empty %}
            <div class="empty-cart-message">
                <p>Votre panier est vide.</p>
                <a href="{{ path('app_collection') }}" class="btn-continue">Découvrir la collection</a>
            </div>
        {% else %}
            <div class="cart-wrapper">
                {# LISTE DES PRODUITS #}
                <div class="cart-items">
                    <div class="cart-header">
                        <span>Produit</span>
                        <span>Quantité</span>
                        <span class="align-right">Total</span>
                    </div>

                    {% for item in items %}
                        <div class="cart-row">
                            {# COLONNE 1 : IMAGE + INFOS #}
                            <div class="product-info">
                                <img src="{{ asset('img/' ~ item.product.image) }}" alt="{{ item.product.title }}">
                                <div class="details">
                                    <span class="product-name">{{ item.product.title }}</span>
                                    <span class="product-price">{{ item.product.price }}</span>
                                </div>
                            </div>

                            {# COLONNE 2 : QUANTITÉ (ICÔNES MINIMALISTES) #}
                            <div class="qty-column">
                                <div class="qty-selector">
                                    <a href="{{ path('cart_decrease', {id: item.product.id}) }}" class="qty-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                    </a>
                                    <span class="qty-number">{{ item.quantity }}</span>
                                    <a href="{{ path('cart_increase', {id: item.product.id}) }}" class="qty-btn">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                    </a>
                                </div>
                                {# Lien supprimer discret #}
                                <a href="{{ path('cart_remove', {id: item.product.id}) }}" class="remove-link">Retirer</a>
                            </div>

                            {# COLONNE 3 : TOTAL LIGNE #}
                            <div class="total-column align-right">
                                {{ item.subtotal|number_format(0, ',', ' ') }} €
                            </div>
                        </div>
                    {% endfor %}
                </div>

                {# RÉSUMÉ ET CHECKOUT #}
                <div class="cart-footer">
                    <div class="subtotal-row">
                        <span>Sous-total</span>
                        <span class="final-price">{{ total|number_format(0, ',', ' ') }} €</span>
                    </div>
                    <p class="tax-note">Taxes et frais de port calculés au paiement.</p>

                    <div class="actions">
                        <a href="{{ path('app_collection') }}" class="back-link">Continuer mes achats</a>
                        <a href="{{ path('cart_checkout') }}" class="btn-checkout">Procéder au Paiement</a>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}
